<analysis>**original_problem_statement:**
The user wants to build a web platform named Alarko Enerji for investing in renewable (RES) and solar (GES) energy projects.

**PRODUCT REQUIREMENTS:**
1.  **Investor Features:**
    *   Invest in projects and earn monthly returns based on a tiered structure (updated to be share-based with USD rate influence).
    *   A dashboard to track portfolio performance (graphs for distribution, cost, returns).
    *   A mock deposit/withdrawal system.
    *   **Withdrawal Flow Update (New):** When requesting a withdrawal, the user should see a list of pre-configured banks (similar to the deposit flow) and also have an option (Diğer Bankalar) to manually enter their own bank/IBAN details.
    *   KYC verification flow where users upload documents for admin approval.
    *   An Account page to manage profile and change password.

2.  **Admin Panel Features:**
    *   Manage users (list, edit details, manually adjust balance).
    *   Manage system bank details for deposits.
    *   Review and approve/reject KYC submissions.
    *   Review and approve/reject withdrawal requests.
    *   Admin email should be editable.

3.  **General Requirements:**
    *   Professional, modern, and visually rich design.
    *   The entire website must be in Turkish.
    *   Authentication via both JWT (email/password) and Google.
    *   Support for multiple admin accounts.
    *   Mobile-responsive design.
    *   Engaging hero section with a video background.

**User's preferred language**: Turkish

**what currently exists?**
A feature-rich, full-stack application with a FastAPI/MongoDB backend and a React/TailwindCSS frontend. The platform is almost complete based on user requests. It includes:
*   User and Admin authentication (JWT & Google).
*   A dynamic, share-based investment system with tiered returns influenced by live USD exchange rates.
*   Admin panel for managing users, KYC, banks, and withdrawal approvals.
*   Investor dashboard and an account management page.
*   A visually polished UI with a video background hero section, responsive design, and full Turkish localization.
*   Comprehensive technical and deployment documentation has been created.

**Last working item**:
*   **Last item agent was working:** The agent was planning the implementation of a new user request to overhaul the withdrawal process. The user wants the withdrawal page to display a list of banks for the user to choose from, and an option to add their own bank details if their bank is not listed.
*   **Status:** NOT STARTED
*   **Agent Testing Done:** N
*   **Which testing method agent to use?** both (The new feature requires frontend UI changes and backend logic updates for handling withdrawal requests with user-provided bank details).
*   **User Testing Done:** N

**All Pending/In progress Issue list**:
There are no pending bugs. The last identified issue (a double-submit bug on the login page) was resolved, and the application passed all tests. The only pending item is the new feature request detailed in Last working item.

**In progress Task List**:
*   **Task 1:** Implement the new withdrawal flow (Priority: P0).
    *   **Where to resume:** The agent has acknowledged the user's request and started planning. The next step is to begin implementation.
        1.  **Backend:** Modify . Update the  model to store user-provided bank/IBAN details for withdrawal requests. Update the  endpoint to accept these new details.
        2.  **Frontend:** Redesign . Fetch the list of admin-configured banks. Create a UI with a bank selection list and a form (initially hidden) for Diğer Bankalar (Other Banks) where the user can input their IBAN and account holder name.
    *   **What will be achieved with this?** The withdrawal process will be more user-friendly and flexible, matching the user's latest requirement.
    *   **Status:** NOT STARTED
    *   **Should Test frontend/backend/both after fix?** Both

**Upcoming and Future Tasks**
*   **Upcoming Tasks:**
    *   **P0:** Complete the implementation and testing of the new withdrawal flow as described above.
    *   **P1:** Implement the dashboard graphs (portfolio distribution, cost, end-of-month return) in  using the  library. This was part of the original plan but was superseded by other UI/UX changes and new requests.

**Completed work in this session**
- **Authentication Flow:**
  - Tested and verified user registration and login flows via both API () and the frontend UI.
  - **Fixed a critical bug** where the login form would submit twice, causing validation errors. The fix involved correcting the logic in  and .
- **Documentation:**
  - Created  detailing the project architecture, API endpoints, database schema, and setup.
  - Created  with step-by-step instructions for deploying the application.
- **Investment Logic Overhaul:**
  - Converted the investment model from a fixed amount to a **share-based system** ().
  - Implemented tiered returns based on the number of shares, with higher tiers including returns calculated against the **live USD exchange rate**.
  - Added a backend endpoint () to fetch the live rate from TCMB and updated the  logic.
  - Updated all relevant frontend components (, ) to reflect the new share-based model.
- **UI/UX Enhancements:**
  - **Hero Section:** Implemented a **rotating video background** on the landing page hero section with a balanced gradient overlay for text readability.
  - **Font & Typography:** Changed the global font to Poppins and increased base font sizes for better readability.
  - **Footer Redesign:** Redesigned the footer with a solar panel background image and gradient overlay, similar to the hero section.
  - **Mobile Responsiveness:** Implemented responsive design adjustments to ensure the site is mobile-friendly.
  - **Localization:** Corrected all remaining Turkish special character (, , , etc.) rendering issues across all pages.
  - **Visual Polish:** Added a solar panel background image and animated icons to the .

**Earlier issues found/mentioned but not fixed**
- None. All known issues have been addressed.

**Known issue recurrence from previous fork**
- N/A

**Code Architecture**


**Key Technical Concepts**
-   **Backend:** FastAPI, MongoDB (with ), Pydantic, JWT authentication,  for external API calls.
-   **Frontend:** React, React Router, TailwindCSS, shadcn/ui, , Context API for state management.
-   **Architecture:** Single Page Application (SPA) with a RESTful API backend.

**key DB schema**
-   **users:** 
-   **projects:** 
-   **investments:** 
-   **banks:** 
-   **transactions:**  (withdrawal_details will be added for the new feature).
-   **kyc_documents:** 

**changes in tech stack**
-   The  library was installed in the backend to fetch live currency data.

**All files of reference**
-   **/app/backend/server.py**: Contains all backend logic. Will need modification for the new withdrawal flow.
-   **/app/frontend/src/pages/WithdrawalPage.jsx**: The main frontend file to be updated for the new task.
-   **/app/frontend/src/pages/LandingPage.jsx**: Heavily modified with video background, new investment plans, and calculator.
-   **/app/frontend/src/pages/LoginPage.jsx**: Updated with a background image and a critical bug fix.
-   **/app/frontend/src/context/AuthContext.js**: Updated to fix the login bug.
-   **/app/frontend/src/components/layout/Footer.jsx**: Redesigned.
-   **/app/frontend/tailwind.config.js** & **/app/frontend/src/index.css**: Updated for the new Poppins font.
-   **/app/TECHNICAL_DOCUMENTATION.md**: New documentation file.
-   **/app/DEPLOYMENT_GUIDE.md**: New documentation file.

**Areas that need refactoring**:
-   The main backend file, , has grown very large (over 700 lines). For better scalability and maintainability, it should be refactored by splitting the logic into a proper project structure:
    -   : For API route definitions.
    -   : For Pydantic models.
    -   : For business logic.

**key api endpoints**
-   
-    (updated for shares)
-    (to be updated for new flow)
-    (update user info)
-   
-    (new)

**Critical Info for New Agent**
Your immediate and highest priority is to implement the user's latest request for a new withdrawal flow. The application is otherwise stable and feature-complete according to all previous requests. You should start by planning the necessary changes to the backend (, models) and the frontend (). After implementing this feature, you should proceed to add the portfolio graphs to the user dashboard, as that is the last remaining feature from the earlier plan.

**documents and test reports created in this job**
-   
-   
-    (updated multiple times)
-    (100% Backend, 100% Frontend success)
-   
-   

**Last 10 User Messages and any pending HUMAN messages**
1.  **User (Latest):** Requested a new withdrawal flow where the user can select from a list of banks or enter their own IBAN details. (Status: **PENDING IMPLEMENTATION**)
2.  **User:** Asked the agent to test the login/registration flow and then provide comprehensive documentation on how the system works and how to deploy it. (Status: **COMPLETED**)
3.  **User:** Requested a rotating video background for the hero section with a reduced gradient. (Status: **COMPLETED**)
4.  **User:** Provided four video files to use for the hero background. (Status: **COMPLETED**)
5.  **User:** Interacted with the agent regarding a screenshot of the hero section. (Status: **COMPLETED**)
6.  **User:** Requested to make the site mobile-compatible, change the font to Poppins with larger text, redesign the footer, and update all pricing references to the new  minimum. (Status: **COMPLETED**)
7.  **User:** Approved the plan to use Poppins font and proceed with other UI changes. (Status: **COMPLETED**)
8.  **User:** Requested new investment tiers (share-based), a live USD exchange rate integration, and UI updates for the login page hero section. (Status: **COMPLETED**)
9.  **User:** Approved the plan to fetch the live USD rate and continue with the implementation. (Status: **COMPLETED**)
10. **User:** Requested changes to the investor panel, including a password change feature, admin approval for withdrawals, and allowing admins to edit user info. (Status: **COMPLETED**)

**Project Health Check:**
-   **Broken:** None. The application is stable and functional.
-   **Mocked:** The deposit flow remains a mock-up (shows bank details for manual transfer). The withdrawal flow is functional but is about to be updated per the user's new request.

**3rd Party Integrations**
-   **Emergent-managed Google Auth:** For social login.
-   **recharts:** Installed for future dashboard graphs.
-   **requests:** Used in the backend to call the TCMB external API for live currency rates.

**Testing status**
-   **Testing agent used after significant changes:** YES. The agent ran comprehensive tests multiple times. The last run reported 100% success on both backend and frontend.
-   **Troubleshoot agent used after agent stuck in loop:** NO.
-   **Test files created:** No formal test files (============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
plugins: anyio-4.12.1
collected 31 items

backend/tests/test_api.py ......................                         [ 70%]
backend/tests/test_share_investment.py ...sss...                         [100%]

======================== 28 passed, 3 skipped in 35.08s ========================) were created. Testing was done via , screenshots, and the testing agent.
-   **Known regressions:** None. The login bug found during this session was fixed.

**Credentials to test flow:**
-   **Admin User:**  / 
-   **Regular User:** Can be created through the registration page.

**What agent forgot to execute**
- The agent did not forget anything. It was in the process of planning the user's latest request when the session was forked. The next agent should pick up this task.</analysis>
